<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Streaming Client Local Test</title>
</head>

<body>
  <script src="../dist/streaming-client.browser.js"></script>
  <script src="index.js"></script>
  <script>
    const authToken = '97M7Y00zgKHtbLMl0w4P4K7mi9gAaK5JHmlcbLkoCQqWlYMOwK9DJDVs0Iee7Zi-l4dGX0J0aqcbmH7bZiQXlA';


    const client = new window.GenesysCloudStreamingClient({
      host: 'wss://streaming.inindca.com',
      authToken
    });

    window.client = client;

    // client.on('*', console.log);
    async function run() {
      // good for reaching 429s
      // await Promise.all([
      //   window.issueTooManyRequests(authToken, 162, 'users/me'),
      //   window.issueTooManyRequests(authToken, 65, 'notifications/channels?connectionType=streaming')
      // ]);

      await client.connect();

      client.webrtcSessions.on('requestIncomingRtcSession', (session) => {
        client.webrtcSessions.acceptRtcSession(session.sessionId)
      });

      client.webrtcSessions.on('incomingRtcSession', session => {
        session.accept();
      });

      // try {
      //   await client.reconnect();
      // } catch (error) {
      //   console.warn('error', { ...error });
      // }
    }

    run();
  </script>
</body>

</html>
